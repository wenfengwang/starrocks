---
displayed_sidebar: English
---

# 大致前K个

## 描述

返回表达式expr中出现频率最高的前k个元素值及其大致的计数。

## 语法

```Haskell
APPROX_TOP_K(<expr> [ , <k> [ , <counter_num> ] ] )
```

## 参数

* expr：STRING、BOOLEAN、DATE、DATETIME或数值类型的表达式。
* k：一个可选的、大于0的INTEGER常量。如果没有指定k，默认值为5。
  *   最大值为100000。
* counter_num：一个可选的、大于或等于k的INTEGER常量。counter_num越大，结果越准确。然而，这也会导致CPU和内存成本的增加。
  *   最大值为100000。
  *   如果没有指定counter_num，默认值为max(min(2 * k, 100), 100000)。

## 返回值

返回结果为一个ARRAY，类型为STRUCT，每个STRUCT包含一个item字段，代表值（保留其原始输入类型），以及一个count字段（类型为BIGINT），包含该值大致出现的次数。数组按count降序排列。

聚合函数返回表达式expr中出现频率最高的前k个元素值及其大致的计数。每个计数的误差可能高达2.0 * numRows / counter_num，其中numRows是总行数。counter_num的值越高，精度越好，但会消耗更多的内存。如果表达式中的不同元素少于counter_num，将得到精确的元素计数。结果中包括NULL值作为单独的元素。

## 示例

```plain
MySQL > SELECT APPROX_TOP_K(L_LINESTATUS) FROM lineitem;
+-------------------------------------------------------------+
| approx_top_k(L_LINESTATUS)                                  |
+-------------------------------------------------------------+
| [{"item":"O","count":3004998},{"item":"F","count":2996217}] |
+-------------------------------------------------------------+

MySQL > SELECT APPROX_TOP_K(L_LINENUMBER) FROM lineitem GROUP BY L_RETURNFLAG
+-------------------------------------------------------------------------------------------------------------------------------------+
| approx_top_k(L_LINENUMBER)                                                                                                          |
+-------------------------------------------------------------------------------------------------------------------------------------+
| [{"item":1,"count":761151},{"item":2,"count":652280},{"item":3,"count":543265},{"item":4,"count":434834},{"item":5,"count":326135}] |
| [{"item":1,"count":368853},{"item":2,"count":316830},{"item":3,"count":263950},{"item":4,"count":211270},{"item":5,"count":158495}] |
| [{"item":1,"count":369996},{"item":2,"count":316718},{"item":3,"count":264179},{"item":4,"count":210911},{"item":5,"count":158657}] |
+-------------------------------------------------------------------------------------------------------------------------------------+
```

## 关键字

APPROX_TOP_K
