---
displayed_sidebar: English
---

# 数据加载

## 1. 如果出现“关闭索引通道失败”或“数位板版本过多”错误，我该怎么办？

您运行加载作业过于频繁，并且数据未及时压缩。因此，在加载过程中生成的数据版本数量超过了允许的最大数据版本数量（默认为 1000）。您可以通过以下方法解决此问题：

- 增加每个单独作业中加载的数据量，从而降低加载频率。

- 修改每个 BE 的 BE 配置文件 **be.conf** 中的配置项，加快数据压缩速度：

    ```Plain
    cumulative_compaction_num_threads_per_disk = 4
    base_compaction_num_threads_per_disk = 2
    cumulative_compaction_check_interval_seconds = 2
    ```

  修改上述配置项后，需要观察内存和 I/O，确保一切正常。

## 2. 如果出现“标签已存在”错误，我该怎么办？

出现此错误是因为该加载作业与同一 StarRocks 数据库中已成功运行或正在运行的另一个加载作业具有相同的标签。

流加载作业是通过 HTTP 提交的。通常，所有编程语言的 HTTP 客户端中都嵌入了请求重试逻辑。当 StarRocks 集群收到来自 HTTP 客户端的加载作业请求时，会立即开始处理该请求，但不会及时将作业结果返回给 HTTP 客户端。因此，HTTP 客户端会再次发送相同的加载作业请求。但是，StarRocks 集群已经在处理第一个请求，因此会为第二个请求返回 `Label Already Exists` 错误。

执行以下操作，检查使用不同加载方法提交的加载作业是否没有相同的标签，并且不会重复提交：

- 查看 FE 日志，检查加载失败作业的标签是否记录了两次。如果标签被记录两次，则客户端已提交两次加载作业请求。

  > **注意**
  >
  > StarRocks 集群不会根据加载方式区分加载作业的标签。因此，使用不同加载方法提交的加载作业可能具有相同的标签。

- 运行 SHOW LOAD WHERE LABEL = “xxx” 以检查具有相同标签且处于 FINISHED 状态的加载作业 **** 。

  > **注意**
  >
  > `xxx` 是要检查的标签。

在提交加载作业之前，建议您计算加载数据所需的大致时间，然后相应地调整客户端请求超时时间。这样，您可以防止客户端多次提交加载作业请求。

## 3. 如果出现“ETL_QUALITY_UNSATISFIED;msg：质量不够好，无法取消“错误，我该怎么办？

执行 [SHOW LOAD](../../sql-reference/sql-statements/data-manipulation/SHOW_LOAD.md)，并使用返回的执行结果中的错误 URL 查看错误详情。

常见的数据质量错误如下：

- “将 csv 字符串转换为 INT 失败。”
  
  源列中的字符串无法转换为匹配目标列的数据类型。例如， `abc` 无法转换为数值。

- “输入的长度比架构长。”
  
  源列中的值的长度不受匹配目标列的支持。例如，CHAR 数据类型的源列值超过创建表时指定的目标列的最大长度，或者 INT 数据类型的源列值超过 4 个字节。

- “实际列号小于架构列号。”
  
  根据指定的列分隔符解析源行后，获取的列数小于目标表中的列数。一个可能的原因是，load 命令或语句中指定的列分隔符与该行中实际使用的列分隔符不同。

- “实际列号大于架构列号。”
  
  根据指定的列分隔符解析源行后，获取的列数大于目标表中的列数。一个可能的原因是，load 命令或语句中指定的列分隔符与该行中实际使用的列分隔符不同。

- “压裂部分长度长于模式比例。”
  
  DECIMAL 类型源列中值的十进制部分超过指定的长度。

- “int 部分长度长于架构精度。”
  
  DECIMAL 类型源列中值的整数部分超过指定的长度。

- “此密钥没有相应的分区。”
  
  源行的分区列中的值不在分区范围内。

## 4. 如果 RPC 超时，我该怎么办？

检查每个 BE 的 BE 配置文件 **be.conf** 中的 `write_buffer_size` 配置项的设置。此配置项用于控制 BE 上每个内存块的最大大小。默认最大大小为 100 MB。如果最大大小过大，远程过程调用（RPC）可能会超时。要解决此问题，请调整 BE 配置文件中 `write_buffer_size` 和 `tablet_writer_rpc_timeout_sec` 配置项的设置。更多信息，请参见[BE 配置](../../loading/Loading_intro.md#be-configurations)。

## 5. 如果出现“值计数与列数不匹配”错误，我该怎么办？

在我的加载作业失败后，我使用作业结果中返回的错误 URL 检索错误详情，发现“值计数与列数不匹配”错误，表示源数据文件中的列数与目标 StarRocks 表中的列数不匹配：

```Java
Error: Value count does not match column count. Expect 3, but got 1. Row: 2023-01-01T18:29:00Z,cpu0,80.99
Error: Value count does not match column count. Expect 3, but got 1. Row: 2023-01-01T18:29:10Z,cpu1,75.23
Error: Value count does not match column count. Expect 3, but got 1. Row: 2023-01-01T18:29:20Z,cpu2,59.44
```

出现此问题的原因是：

load 命令或语句中指定的列分隔符与源数据文件中实际使用的列分隔符不同。在前面的示例中，CSV 格式的数据文件由三列组成，用逗号（`,`）分隔。但是，在 load 命令或语句中指定了 `\t` 作为列分隔符。因此，源数据文件中的三列被错误地解析为一列。

请在 load 命令或语句中指定逗号（`,`）作为列分隔符，然后重新提交加载作业。
