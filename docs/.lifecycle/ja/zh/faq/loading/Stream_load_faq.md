---
displayed_sidebar: Chinese
---

# Stream Load 常见问题

## 1. Stream Load 是否支持识别 CSV 格式文件开头前几行的列名？或者是否支持在数据读取过程中跳过开头前几行数据？

Stream Load は、CSV 形式のファイルの先頭にある数行の列名を識別することはできません。列名は Stream Load にとって他の行と同様に、ただのデータです。

バージョン 2.5 以前では、Stream Load はデータ読み込みプロセス中に CSV 形式ファイルの先頭の数行をスキップすることはできませんでした。もし、インポートする CSV 形式ファイルの先頭に列名がある場合、以下の四つの方法で処理することができます：

- エクスポートツールの設定を変更し、列名を含まない CSV 形式ファイルを再エクスポートします。

- `sed -i '1d' filename` などのコマンドを使用して、CSV 形式ファイルの最初の数行を削除します。

- Stream Load の実行コマンドまたはステートメントで `-H "where: <column_name> != '<column_name>'"` を使用して、最初の数行をフィルタリングします。ここで `<column_name>` は CSV 形式ファイルの最初の数行にある任意の列名です。ただし、現在の StarRocks は変換を先に行い、その後にフィルタリングを行うため、最初の数行の列値が他のデータ型への変換に失敗すると `NULL` を返すことに注意が必要です。したがって、このインポート方法では StarRocks のテーブルの列に `NOT NULL` が設定されていないことが必要です。

- Stream Load の実行コマンドまたはステートメントに `-H "max_filter_ratio:0.01"` を追加します。これにより、インポートジョブに 1% またはそれ以下の、しかし数行のエラーを許容する許容率を設定し、最初の数行のエラーを無視することができます。許容率を設定した後でも、結果の `ErrorURL` はエラーがあったことを示しますが、インポートジョブ全体は成功します。許容率は大きく設定しすぎないように注意し、他のデータ問題を見逃さないようにしてください。

バージョン 3.0 以降、Stream Load は `skip_header` パラメータをサポートし、CSV ファイルの先頭の数行をスキップするように指定できます。詳細は [CSV 适用参数](../../sql-reference/sql-statements/data-manipulation/STREAM_LOAD.md#csv-适用参数) を参照してください。

## 2. 現在のビジネスのパーティションキーに対応するデータが標準の DATE および INT 型ではなく、たとえば 202106.00 の形式である場合、これらのデータを StarRocks にインポートするために Stream Load を使用する必要がある場合、どのように変換すればよいですか？

StarRocks はインポートプロセス中にデータ変換をサポートしています。詳細は[インポートプロセス中のデータ変換](../../loading/Etl_in_loading.md)を参照してください。

例えば、ソースデータファイル `TEST` が CSV 形式であり、`NO`、`DATE`、`VERSION`、`PRICE` の四つの列を含んでいるが、その中の `DATE` 列が不規則な 202106.00 形式であるとします。StarRocks で使用するパーティション列が `DATE` である場合、まず StarRocks に `NO`、`VERSION`、`PRICE`、`DATE` の四つの列を含むテーブルを作成する必要があります。`DATE` 列のデータ型を DATE、DATETIME、または INT として指定する必要があります。その後、Stream Load の実行コマンドまたはステートメントで、以下の設定を指定して列間の変換を実現します：

```Plain
-H "columns: NO,DATE_1, VERSION, PRICE, DATE=LEFT(DATE_1,6)"
```

`DATE_1` は、一時的にデータを取得するためのプレースホルダとして簡単に考えることができ、その後 `left()` 関数を使用して変換し、StarRocks のテーブルの `DATE` 列に値を割り当てます。特に注意が必要なのは、CSV ファイル内のすべての列の一時名を最初にリストアップし、その後で関数を使用して変換する必要があることです。列変換に対応する関数はスカラー関数であり、集約関数やウィンドウ関数を含まない関数です。

## 3. インポートエラー "body exceeds max size: 10737418240, limit: 10737418240" はどのように解決すればよいですか？

ソースデータファイルのサイズが 10 GB を超えており、Stream Load がサポートするファイルサイズの上限を超えています。解決方法は二つあります：

- `seq -w 0 n` を使用してデータファイルを分割します。
- `curl -XPOST http:///be_host:http_port/api/update_config?streaming_load_max_mb=<file_size>` を使用して [BE 配置项](../../administration/BE_configuration.md) の `streaming_load_max_mb` の値を調整し、ファイルサイズの上限を拡大します。
