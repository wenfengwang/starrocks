---
displayed_sidebar: Chinese
---

# ファイルマネージャー

本文では、ファイルマネージャーを使用してファイルを作成、閲覧、削除する方法について説明します。StarRocks では、公開鍵、秘密鍵、証明書ファイルなどをシステムにアップロードして保存し、コマンドで参照またはアクセスすることができます。

## 基本概念

**ファイル**：StarRocks に作成され保存されるファイルを指します。各ファイルにはグローバルに一意の識別子 (`FileId`) があります。ファイルはデータベース名 (`database`)、カテゴリ (`catalog`)、ファイル名 (`file_name`) の3つで特定されます。

System レベルの FILE 権限を持つユーザーのみがファイルを作成および削除できます。ファイルがあるデータベースに属している場合、そのデータベースへのアクセス権を持つユーザーは誰でもそのファイルを使用できます。

## 前提条件

ファイルマネージャーを使用する前に、以下の設定が必要です：

- FE の設定
  - `small_file_dir`：アップロードされたファイルを保存するディレクトリ。デフォルトパスは FE の実行ディレクトリ内の small_files/ ディレクトリです。**fe.conf** ファイルでこの設定を変更し、FE を再起動すると有効になります。
  - `max_small_file_size_bytes`：単一ファイルの最大サイズ制限。単位はバイトで、デフォルトは 1 MB です。このパラメータ値を超えるファイルは作成できません。[ADMIN SET CONFIG](../sql-reference/sql-statements/Administration/ADMIN_SET_CONFIG.md) ステートメントを使用して、この設定をオンラインで変更できます。
  - `max_small_file_number`：StarRocks クラスターがサポートするファイルの総数。デフォルトは 100 です。作成されるファイルの数がこのパラメータ値を超えると、以降の作成は拒否されます。ADMIN SET CONFIG ステートメントを使用して、この設定をオンラインで変更できます。

> 注意：ファイルの数とサイズが増えると、FE のメモリ使用量が増加するため、必要でない限り `max_small_file_size_bytes` と `max_small_file_number` の値を増やすことは推奨されません。

- BE の設定：**be.conf** ファイルで `small_file_dir` 設定項目を設定します。`small_file_dir` はファイルマネージャーがダウンロードしたファイルを保存するディレクトリです。デフォルト値は BE の実行ディレクトリの `lib/small_files/` です。

## ファイルの作成

CREATE FILE ステートメントを使用してファイルを作成します。具体的な構文とパラメータについては、[CREATE FILE](../sql-reference/sql-statements/Administration/CREATE_FILE.md) を参照してください。ファイルは作成後に自動的にアップロードされ、StarRocks クラスターに永続化されます。

## ファイルの閲覧

SHOW FILE ステートメントを使用して、データベースに保存されているファイルの情報を閲覧します。具体的な構文とパラメータについては、[SHOW FILE](../sql-reference/sql-statements/Administration/SHOW_FILE.md) を参照してください。

## ファイルの削除

DROP FILE ステートメントを使用してファイルを削除します。具体的な構文とパラメータについては、[DROP FILE](../sql-reference/sql-statements/Administration/DROP_FILE.md) を参照してください。

## ファイルの使用

- FE がファイルを使用する場合、SmallFileMgr クラスは FE のメモリ内のデータを直接ローカルファイルとして保存し、指定されたディレクトリに格納し、FE が使用するためのローカルファイルパスを返します。
- BE がファイルを使用する場合、BE は FE の HTTP インターフェース **/api/get_small_file** を通じてファイルをダウンロードし、BE が指定したディレクトリで使用します。同時に、BE はメモリ内に既にダウンロードされたファイルの情報を記録します。BE がファイルの使用を要求すると、まずローカルにそのファイルが存在するかを確認し、ファイルを検証します。検証が成功すれば、ローカルファイルパスを返します。検証に失敗した場合は、ローカルファイルを削除し、FE から再ダウンロードします。BE が再起動する際には、事前にローカルのファイルをメモリにロードします。
