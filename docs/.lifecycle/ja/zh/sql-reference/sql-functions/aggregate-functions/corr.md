---
displayed_sidebar: Chinese
---

# corr

## 機能

2つのランダム変数のピアソンの相関係数（correlation coefficient）を返します。この関数はバージョン2.5.10からサポートされており、ウィンドウ関数としても使用できます。

## 文法

```Haskell
CORR(expr1, expr2)
```

## 引数説明

`expr1`: 選択された式1。

`expr2`: 選択された式2。

式がテーブルの列である場合、2つの列の値の間の相関係数を計算するために使用されます。以下のデータ型をサポートしています: TINYINT、SMALLINT、INT、BIGINT、LARGEINT、FLOAT、DOUBLE、DECIMAL。

## 戻り値の説明

戻り値はDOUBLE型です。計算式は以下の通りで、`n`はテーブルの行数です：

![corr_formula](../../../assets/corr_formula.png)

<!--$$
\frac{\sum_{i=1}^{n}((x_i - \bar{x})(y_i - \bar{y}))}{\sqrt{\sum_{i=1}^{n}((x_i - \bar{x})^2) \cdot \sum_{i=1}^{n}((y_i - \bar{y})^2)}}
$$ -->

## 使用説明

* 相関係数を計算する際、同じ行の2つの列のデータが両方ともnullでない場合にのみ、その行のデータが最終結果に統計されます。そうでない場合は、その行のデータは無視されます。

* `n`が1の場合、戻り値は0です。

## 例

以下のデータテーブルに対して：

```plaintext
mysql> select * from agg;
+------+-------+-------+
| no   | k     | v     |
+------+-------+-------+
|    1 | 10.00 |  NULL |
|    2 | 10.00 | 11.00 |
|    2 | 20.00 | 22.00 |
|    2 | 25.00 |  NULL |
|    2 | 30.00 | 35.00 |
+------+-------+-------+
```

列 `k` と列 `v` の相関係数を計算します:

```plaintext
mysql> select no,CORR(k,v) from agg group by no;
+------+--------------------+
| no   | corr(k, v)         |
+------+--------------------+
|    1 |               NULL |
|    2 | 0.9988445981121532 |
+------+--------------------+
```
