---
displayed_sidebar: Chinese
---

# json_length

## 機能

JSON文字列の長さを返します。`path`が指定された場合は、`path`で指定された値の長さを返します。

この関数は以下のルールに従ってJSON文字列の長さを計算します：

- 単一値の長さは1です。例えば、`1`、`"a"`、`true`、`false`、`null`の長さはすべて1です。

- 配列（array）の長さは配列内の要素数です。例えば`[1, 2]`の長さは2です。

- オブジェクト（object）の長さはオブジェクト内のメンバー（key）の数です。例えば`{"a": 1}`の長さは1です。

- ネストされた配列やオブジェクトは長さの計算に含まれません。例えば`{"a": [1, 2]}`の長さは1です。なぜなら外側のJSONオブジェクトの長さを計算し、ネストされた配列`[1, 2]`の長さは計算しないからです。

## 文法

```SQL
json_length(json_doc[, path])
```

## パラメータ説明

- `json_doc`：JSON文字列、必須。

- `path`：パス式、オプション。データ型はVARCHARです。`path`は通常`$`記号で始まり、`.`をパスの区切りとして使用し、`[]`は配列のインデックスを示し、0から始まります。

## 戻り値の説明

INT型の値を返します。

`json_doc`で指定されたJSON文字列が無効な場合は、エラーを返します。

以下の場合、0を返します：

- JSON文字列に`path`で指定されたパスが存在しない。
- `path`で指定されたパスが有効なパス式ではない。
- `path`に`*`または`**`のワイルドカードが含まれている。

## 例

例1：単一値の長さを返します。

```Plain
select json_length('1');
+------------------+
| json_length('1') |
+------------------+
|                1 |
+------------------+
```

例2：空のオブジェクトの長さを返します。

```Plain
select json_length('{}');
+-------------------+
| json_length('{}') |
+-------------------+
|                 0 |
+-------------------+
```

例3：JSONオブジェクトの長さを返します。

```Plain
select json_length('{"Name": "Alice"}');
+----------------------------------+
| json_length('{"Name": "Alice"}') |
+----------------------------------+
|                                1 |
+----------------------------------+
```

例4：JSON配列の長さを返します。

```plain text
select json_length('[1, 2, 3]');
+--------------------------+
| json_length('[1, 2, 3]') |
+--------------------------+
|                        3 |
+--------------------------+
```

例5：配列の要素に配列[3, 4]がネストされていますが、ネストされた配列は長さに含まれないため、長さは依然として3です。

```plain text
select json_length('[1, 2, [3, 4]]');
+-------------------------------+
| json_length('[1, 2, [3, 4]]') |
+-------------------------------+
|                             3 |
+-------------------------------+
```

例6：JSON文字列内のパス式で指定された値の長さを返します。

```SQL
SET @file = '{  
    "Employee": {    
       "Name": "Alice", 
       "Age": 32,
       "Hobbies": ["Dancing", "Shopping"]  
    }
 }';
 
select json_length(@file, '$.Employee');
+----------------------------------+
| json_length(@file, '$.Employee') |
+----------------------------------+
|                                3 |
+----------------------------------+
```

例7：パス式で指定された値の長さを返します。

```plain text
select json_length('{"x": 1, "y": [1, 2]}', '$.y');
+---------------------------------------------+
| json_length('{"x": 1, "y": [1, 2]}', '$.y') |
+---------------------------------------------+
|                                           2 |
+---------------------------------------------+
```
