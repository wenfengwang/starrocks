---
displayed_sidebar: Chinese
---

# json_each

## 機能

JSON オブジェクトの最外層をキーと値に展開し、一行または複数行のデータ集合として返します。

## 文法

```Plain Text
JSON_EACH(json_object_expr)
```

## パラメータ説明

`json_object_expr`：JSON オブジェクトの式で、JSON 型の列や PARSE_JSON などの JSON 関数で構築された JSON オブジェクトが使用できます。

## 戻り値の説明

キーと値の2列を返します。キーの列名は `key`、値の列名は `value` です。キーと値の列の型はそれぞれ VARCHAR と JSON です。
> `key` は予約語なので、select 文で列名を指定する際には **t.\`key\`** のように記述する必要があります（下記の例を参照）。

## 注意事項

JSON_EACH はテーブル関数であり、行の集合を返します。したがって、JSON_EACH は FROM 句で LATERAL 結合を使用して使用する必要があります（LATERAL キーワードは省略可能です）。SELECT 句で使用することはできません。

## 例

```Plain Text
-- 以下の例では、tj テーブルを使用して説明します。
mysql> SELECT * FROM tj;
+------+------------------+
| id   | j                |
+------+------------------+
|    1 | {"a": 1, "b": 2} |
|    3 | {"a": 3}         |
+------+------------------+

-- tj テーブルの j 列は JSON 型のオブジェクトで、キーと値に展開して複数行のデータ集合を得た後、LATERAL 結合で tj テーブルと結合します。
mysql> SELECT * FROM tj, LATERAL JSON_EACH(j);
+------+------------------+------+-------+
| id   | j                | key  | value |
+------+------------------+------+-------+
|    1 | {"a": 1, "b": 2} | a    | 1     |
|    1 | {"a": 1, "b": 2} | b    | 2     |
|    3 | {"a": 3}         | a    | 3     |
+------+------------------+------+-------+

mysql> SELECT tj.*, t2.`key` as j_key, t2.value as j_val FROM tj, LATERAL JSON_EACH(j) as t2;
+------+------------------+-------+-------+
| id   | j                | j_key | j_val |
+------+------------------+-------+-------+
|    1 | {"a": 1, "b": 2} | a     | 1     |
|    1 | {"a": 1, "b": 2} | b     | 2     |
|    3 | {"a": 3}         | a     | 3     |
+------+------------------+-------+-------+
```
