---
displayed_sidebar: Chinese
---

# array_filter

## 機能

設定されたフィルタ条件に基づいて、配列内の一致する要素を返します。この関数は通常の配列フィルタリングに使用できるほか、Lambda 関数を組み合わせてより柔軟な配列フィルタリングを行うことができます。Lambda 式の詳細については、[Lambda expression](../Lambda_expression.md)を参照してください。この関数はバージョン 2.5 からサポートされています。

## 文法

```Haskell
array_filter(array, array<bool>)
array_filter(lambda_function, arr1,arr2...)
```

- `array_filter(array, array<bool>)`

   `array` の各要素を `array<bool>` 関数に渡して判断します。`array<bool>` が `true` を返した場合、その要素を結果の配列に返します。

- `array_filter(lambda_function, arr1,arr2...)`

   `lambda_function` を各入力配列に適用し、一致する配列を返します。

## パラメータ説明

- `array`: フィルタリングする配列。

- `array<bool>`: 配列をフィルタリングするための式。

- `lambda_function`: 配列をフィルタリングするための Lambda 式。

## 注意事項

- `array_filter(array, array<bool>)` の両方の入力パラメータは ARRAY 型でなければならず、2番目のパラメータは `array<bool>` に互換性があるか、変換可能でなければなりません。
- `array_filter(lambda_function, arr1,arr2...)` での Lambda 関数の要件は [array_map()](./array_map.md) と同じです。
- 入力配列が null の場合は null を返し、フィルタリング用の配列が null の場合は空の配列を返します。

## 例

### Lambda 式を使用しない場合

  ```plain
    -- 配列内のすべての要素がフィルタ条件に一致するため、配列内のすべての要素を返します。
    select array_filter([1,2,3],[1,1,1]);
    +------------------------------------+
    | array_filter([1, 2, 3], [1, 1, 1]) |
    +------------------------------------+
    | [1,2,3]                            |
    +------------------------------------+
    1 row in set (0.01 sec)
    
    -- フィルタ条件に一致する要素を返します。1番目と3番目の要素が一致します。
    select array_filter([1,2,3],[1,0,1]);
    +------------------------------------+
    | array_filter([1, 2, 3], [1, 0, 1]) |
    +------------------------------------+
    | [1,3]                              |
    +------------------------------------+
    1 row in set (0.01 sec)
    
    -- フィルタ配列が null の場合、空の配列を返します。
    select array_filter([1,2,3],null);
    +-------------------------------+
    | array_filter([1, 2, 3], NULL) |
    +-------------------------------+
    | []                             |
    +-------------------------------+
    1 row in set (0.01 sec)
    
    -- 入力配列が null の場合、null を返します。
    select array_filter(null,[1]);
    +-------------------------+
    | array_filter(NULL, [1]) |
    +-------------------------+
    | NULL                    |
    +-------------------------+
    
    -- 入力配列とフィルタ配列の両方が null の場合、null を返します。
    select array_filter(null,null);
    +--------------------------+
    | array_filter(NULL, NULL) |
    +--------------------------+
    | NULL                     |
    +--------------------------+
    1 row in set (0.01 sec)
    
    -- フィルタ配列の要素が null の場合、空の配列を返します。
    select array_filter([1,2,3],[null]);
    +---------------------------------+
    | array_filter([1, 2, 3], [NULL]) |
    +---------------------------------+
    | []                              |
    +---------------------------------+
    1 row in set (0.01 sec)
    
    -- フィルタ配列の2つの要素が null の場合、空の配列を返します。
    select array_filter([1,2,3],[null,null]);
    +---------------------------------------+
    | array_filter([1, 2, 3], [NULL, NULL]) |
    +---------------------------------------+
    | []                                    |
    +---------------------------------------+
    1 row in set (0.00 sec)
    
    -- 条件に合致する要素 2 のみを返します。
    select array_filter([1,2,3],[null,1,0]);
    +---------------------------------------+
    | array_filter([1, 2, 3], [NULL, 1, 0]) |
    +---------------------------------------+
    | [2]                                   |
    +---------------------------------------+
  ```

### Lambda 式を使用する場合

  ```plain
    -- 配列 `x` の要素が配列 `y` の要素より小さい場合に、その要素を返します。
    select array_filter((x,y) -> x < y, [1,2,null], [4,5,6]);
    +--------------------------------------------------------+
    | array_filter((x, y) -> x < y, [1, 2, NULL], [4, 5, 6]) |
    +--------------------------------------------------------+
    | [1,2]                                                  |
    +--------------------------------------------------------+
  ```
