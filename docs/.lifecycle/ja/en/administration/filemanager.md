---
displayed_sidebar: English
---

# ファイルマネージャー

ファイルマネージャーを使用すると、外部データソースへのアクセスに使用されるファイル（公開鍵ファイル、秘密鍵ファイル、証明書ファイル）などのファイルを作成、表示、および削除できます。作成したファイルは、コマンドを使用して参照またはアクセスできます。

## 基本概念

**ファイル**: StarRocksで作成および保存されるファイルを指します。ファイルが作成され、StarRocksに保存されると、StarRocksはファイルに一意のIDを割り当てます。データベース名、カタログ、およびファイル名に基づいてファイルを検索できます。データベースでは、管理者ユーザーのみがファイルを作成および削除でき、データベースにアクセスする権限を持つすべてのユーザーがデータベースに属するファイルを使用できます。

## 始める前に

- 各FEに以下のパラメータを設定します。
  - `small_file_dir`: アップロードされたファイルが保存されるパス。デフォルトのパスは `small_files/` で、FEのランタイムディレクトリ内にあります。このパラメータは **fe.conf** ファイルで指定し、FEを再起動して変更を有効にする必要があります。
  - `max_small_file_size_bytes`: 単一ファイルの最大サイズ。このパラメータのデフォルト値は1MBです。ファイルのサイズがこのパラメータの値を超えると、ファイルを作成できません。このパラメータは、[ADMIN SET CONFIG](../sql-reference/sql-statements/Administration/ADMIN_SET_CONFIG.md) ステートメントを使用して指定できます。
  - `max_small_file_number`: クラスタ内で作成できるファイルの最大数。このパラメータのデフォルト値は100です。作成したファイルの数がこのパラメータの値に達すると、ファイルの作成を続行できません。このパラメータは、ADMIN SET CONFIG ステートメントを使用して指定できます。

> 注: これら2つのパラメータの値を増やすと、FEのメモリ使用量が増加します。したがって、必要でない限り、これらのパラメータの値を増やさないことをお勧めします。

- 各BEに次のパラメータを設定します。

`small_file_dir`: ダウンロードしたファイルが保存されるパス。デフォルトのパスは `lib/small_files/` で、BEのランタイムディレクトリ内にあります。このパラメータは **be.conf** ファイルで指定できます。

## ファイルを作成する

CREATE FILE ステートメントを実行してファイルを作成できます。詳細については、[CREATE FILE](../sql-reference/sql-statements/Administration/CREATE_FILE.md)を参照してください。ファイルが作成されると、そのファイルはアップロードされ、StarRocksに永続化されます。

## ファイルを表示する

SHOW FILE ステートメントを実行してデータベースに格納されているファイルに関する情報を表示できます。詳細については、[SHOW FILE](../sql-reference/sql-statements/Administration/SHOW_FILE.md)を参照してください。

## ファイルを削除する

DROP FILE ステートメントを実行してファイルを削除できます。詳細については、[DROP FILE](../sql-reference/sql-statements/Administration/DROP_FILE.md)を参照してください。

## FEとBEがファイルを使用する方法

- **FE**: `SmallFileMgr` クラスは、FEの指定ディレクトリにファイルに関連するデータを格納します。その後、`SmallFileMgr` クラスは、FEがファイルを使用するためのローカルファイルパスを返します。
- **BE**: BEは **/api/get_small_file API** (HTTP) を呼び出して、指定されたディレクトリにファイルをダウンロードし、ファイルの情報を記録します。BEがファイルの使用を要求する際、BEはファイルがダウンロードされているかをチェックし、その後ファイルを検証します。ファイルが検証を通過すれば、ファイルのパスが返されます。ファイルが検証に失敗した場合、ファイルは削除され、FEから再ダウンロードされます。BEが再起動する際には、ダウンロードされたファイルがメモリにプリロードされます。
