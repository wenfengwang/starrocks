---
displayed_sidebar: English
---

# テーブルタイプの概要

テーブルを作成する際には、テーブルタイプを指定し、ソートキーとして1つ以上のカラムを定義する必要があります。これにより、作成したテーブルにデータが初めてロードされた際、StarRocksはソートキーに基づいてデータをソート、処理、保存することができます。このトピックでは、StarRocksが提供するさまざまなビジネス要件に対応するテーブルタイプについて説明します。

## 基本概念

### テーブルタイプ

StarRocksは、Duplicate Keyテーブル、Aggregateテーブル、Unique Keyテーブル、Primary Keyテーブルの4種類のテーブルタイプを提供しています。これら4つのテーブルタイプは、ログ分析、データ集計と分析、リアルタイムデータ分析など、幅広いデータ分析シナリオに適しています。

### ソートキー

特定のテーブルタイプを使用して作成されたテーブルにデータがロードされると、テーブル作成時にソートキーとして定義された1つ以上のカラムに基づいてデータがソートされ、格納されます。ソートキーは通常、クエリでフィルタ条件として頻繁に使用される1つ以上のカラムであり、クエリの速度を向上させます。

Duplicate Keyテーブルでは、`DUPLICATE KEY`で指定されたソートキーがデータのソートに使用され、UNIQUE制約は割り当てられません。
Aggregateテーブルでは、`AGGREGATE KEY`で指定されたソートキーがデータのソートに使用され、UNIQUE制約が割り当てられます。
Unique Keyテーブルでは、`UNIQUE KEY`で指定されたソートキーがデータのソートに使用され、UNIQUE制約が割り当てられます。
Primary Keyテーブルでは、プライマリキーとソートキーが分離されています。`PRIMARY KEY`で指定されるプライマリキーにはUNIQUEおよびNOT NULL制約が割り当てられます。`ORDER BY`で指定されたソートキーはデータのソートに使用されます。

> **注記**
>
> - v3.0より前のバージョンでは、Primary Keyテーブルはプライマリキーとソートキーを別々に定義することをサポートしていません。
> - ソートキーの詳細については、[ソートキーとプレフィックスインデックス](../Sort_key.md)を参照してください。

## 注意事項

- ソートキーカラムは、テーブル作成のステートメント内で他のカラムよりも先に定義する必要があります。

- テーブル作成時のステートメントでのソートキーカラムの順序は、テーブル内の行がソートされる条件の順序を指定します。

- テーブルのプレフィックスインデックスの長さは36バイトに制限されています。ソートキーカラムの合計長が36バイトを超える場合、StarRocksは長さ制限内の最初の数カラムのみをプレフィックスインデックスとして格納します。

- テーブルにロードされるレコードが同じプライマリキーを持つ場合、StarRocksはテーブルタイプに基づいてレコードを処理し、保存します。
  - Duplicate Keyテーブル

    StarRocksは、各レコードを個別の行としてテーブルにロードします。データロードが完了すると、テーブルには同じプライマリキーを持つ行が含まれ、これらの行はソースレコードと1対1の関係をマッピングします。ロードした全ての履歴データを取り出すことができます。

  - Aggregateテーブル

    StarRocksは、レコードを1つのレコードに集約し、その集約されたレコードを行としてテーブルにロードします。ロードが完了すると、テーブルには同じプライマリキーを持つ行は含まれなくなります。ロードした全ての履歴データの集約結果を取り出すことができますが、全ての履歴データを取り出すことはできません。

  - Unique KeyテーブルとPrimary Keyテーブル

    StarRocksは、新しくロードされたレコードを以前にロードされたレコードと置き換え、最新のレコードのみをテーブルの行として保持します。ロードが完了すると、テーブルには同じプライマリキーを持つ行は含まれなくなります。Unique KeyテーブルとPrimary Keyテーブルは、同じプライマリキーを持つレコード群の中で最新のレコードを返すREPLACE集約関数が指定された特別なAggregateテーブルと考えることができます。
