---
displayed_sidebar: "中文"
---

# 表类型概述

在创建表时，您必须指定表类型并将一个或多个列定义为排序键。这样，当数据最初加载到您创建的表中时，StarRocks 可以根据排序键对数据进行排序、处理和存储。本主题描述了 StarRocks 提供的表类型，以满足您不同的业务需求。

## 基本概念

### 表类型

StarRocks 提供四种表类型：重复键表、聚合表、唯一键表和主键表。这四种表类型非常适合各种数据分析场景，如日志分析、数据聚合和分析以及实时数据分析等。

### 排序键

当数据加载到使用特定表类型创建的表中时，数据根据在创建表时定义为排序键的一个或多个列进行排序和存储。排序键通常是一个或多个经常用作查询中的过滤条件的列，从而加速查询。

在重复键表中，由 `DUPLICATE KEY` 指定的排序键用于对数据进行排序和不分配唯一约束。
在聚合表中，由 `AGGREGATE KEY` 指定的排序键用于对数据进行排序并分配唯一约束。
在唯一键表中，由 `UNIQUE KEY` 指定的排序键用于对数据进行排序并分配唯一约束。
在主键表中，主键和排序键是解耦的。由 `PRIMARY KEY` 指定的主键分配了唯一和 NOT NULL 约束。由 `ORDER BY` 指定的排序键用于对数据进行排序。

> **注意**
>
> - 在 v3.0 之前的版本中，主键表不支持单独定义主键和排序键。
> - 有关排序键的更多描述，请参见[排序键和前缀索引](../Sort_key.md)。

## 注意事项

- 必须在创建表的语句中优先定义排序键列。

- 创建表的语句中排序键列的顺序指定了表中行排序的条件顺序。

- 表的前缀索引长度限制为 36 个字节。如果排序键列的总长度超过 36 个字节，StarRocks 仅存储前几个排序键列，这些列的长度未超过前缀索引的长度限制。

- 如果要加载到表中的记录具有相同的主键，则 StarRocks 根据表类型处理和存储记录：
  - 重复键表

    StarRocks 将每条记录作为单独的行加载到表中。数据加载完成后，表中包含具有相同主键的行，并且行与源记录的映射是一对一的关系。您可以检索所有加载的历史数据。

  - 聚合表

    StarRocks 将记录聚合为一条记录，并将聚合后的记录作为一行加载到表中。加载完成后，表中不包含具有相同主键的行。您可以检索所有加载的历史数据的聚合结果。但是，您无法检索所有历史数据。

  - 唯一键表和主键表

    StarRocks 用新加载的每条记录替换先前加载的记录，并仅保留最近加载的记录作为表中的一行。加载完成后，表中不包含具有相同主键的行。唯一键表和主键表可以看作是一种特殊的聚合表，在此表中为度量列指定 REPLACE 聚合函数，以返回具有相同主键的记录组中最近的记录。