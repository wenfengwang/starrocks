---
displayed_sidebar: "Chinese"
---

# approx_top_k

## 描述

返回`expr`中出现频率最高的`k`个项目值以及其近似计数。

## 语法

```Haskell
APPROX_TOP_K(<expr> [ , <k> [ , <counter_num> ] ] )
```

## 参数

* `expr`: 一个字符串、布尔值、日期、日期时间或数值类型的表达式。
* `k`: 可选的大于0的整数文字。 如果未指定`k`，则默认为`5`。
    * 最大值为`100000`
* `counter_num`: 可选的大于等于`k`的整数文字。 `counter_num`越大，结果的准确性就越高。但这也会增加CPU和内存成本。
    * 最大值为`100000`
    * 如果未指定`counter_num`，则默认为`max(min(2 * k, 100), 100000)`。

## 返回

结果作为STRUCT类型的数组返回，其中每个STRUCT都包含一个`item`字段表示值（以其原始输入类型），以及一个`count`字段（BIGINT类型）表示近似出现次数。数组按`count`降序排列。

聚合函数返回表达式`expr`中出现频率最高的`k`个项目值以及其近似计数。每个计数的误差可能高达`2.0 * numRows / counter_num`，其中`numRows`是总行数。较大的`counter_num`值提供更高的准确性，但会增加内存使用量。具有少于`counter_num`个不同项目的表达式将产生精确的项目计数。结果包括`NULL`值作为结果中的单独项目。

## 示例

```plain text
MySQL > SELECT APPROX_TOP_K(L_LINESTATUS) FROM lineitem;
+-------------------------------------------------------------+
| approx_top_k(L_LINESTATUS)                                  |
+-------------------------------------------------------------+
| [{"item":"O","count":3004998},{"item":"F","count":2996217}] |
+-------------------------------------------------------------+

MySQL > SELECT APPROX_TOP_K(L_LINENUMBER) FROM lineitem GROUP BY L_RETURNFLAG
+-------------------------------------------------------------------------------------------------------------------------------------+
| approx_top_k(L_LINENUMBER)                                                                                                          |
+-------------------------------------------------------------------------------------------------------------------------------------+
| [{"item":1,"count":761151},{"item":2,"count":652280},{"item":3,"count":543265},{"item":4,"count":434834},{"item":5,"count":326135}] |
| [{"item":1,"count":368853},{"item":2,"count":316830},{"item":3,"count":263950},{"item":4,"count":211270},{"item":5,"count":158495}] |
| [{"item":1,"count":369996},{"item":2,"count":316718},{"item":3,"count":264179},{"item":4,"count":210911},{"item":5,"count":158657}] |
+-------------------------------------------------------------------------------------------------------------------------------------+
```

## 关键词

APPROX_TOP_K
