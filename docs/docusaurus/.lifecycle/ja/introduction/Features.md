---
displayed_sidebar: "Japanese"
---

# 特徴

StarRocksは、スケールにわたるデータに対して高速なリアルタイム分析体験を提供するための豊富な機能を提供しています。

## MPPフレームワーク

StarRocksは、マッシブ並列処理（MPP）フレームワークを採用しています。1つのクエリリクエストは、複数の物理的なコンピューティングユニットに分割され、複数のマシンで並列に実行することができます。各マシンには専用のCPUとメモリリソースがあります。MPPフレームワークは、すべてのCPUコアとマシンのリソースを最大限に活用します。クラスタがスケールアウトされるにつれて、単一のクエリのパフォーマンスが連続的に向上します。

![MPP](../assets/1.1-3-mpp.png)

前の図では、StarRocksはSQLステートメントをセマンティクスに応じて複数の論理的な実行単位（クエリフラグメント）に分割します。それぞれのフラグメントは、計算の複雑さに基づいて1つまたは複数の物理的な実行単位（フラグメントインスタンス）によって実装されます。物理的な実行単位はStarRocksでの最小のスケジューリング単位です。それらはバックエンド（BE）にスケジュールされて実行されます。1つの論理的な実行単位には、スキャン、プロジェクト、集計などのオペレータが含まれる場合があります。図の右側に示すように、各物理実行単位はデータの一部のみを処理し、結果はマージされて最終的なデータを生成します。**論理的な実行単位の並列実行は、すべてのCPUコアと物理マシンのリソースを最大限に活用してクエリの処理速度を高速化します。**

![MPP](../assets/1.1-4-mpp.png)

多くの他のデータ分析システムで使用されるScatter-Gatherフレームワークとは異なり、MPPフレームワークはより多くのリソースを使用してクエリリクエストを処理することができます。Scatter-Gatherフレームワークでは、Gatherノードのみが最終的なマージ操作を実行できます。MPPフレームワークでは、データはマージ操作のために複数のノードにシャッフルされます。高基数フィールドや大規模なテーブルの結合などの複雑なクエリの場合、StarRocksのMPPフレームワークはScatter-Gatherフレームワークよりも明らかなパフォーマンスの優位性を持っています。

## 完全ベクトル化実行エンジン

完全ベクトル化実行エンジンは、データをカラム形式で組織化し処理することにより、CPUの処理能力を効率的に活用します。具体的には、StarRocksはデータをカラム形式で保存し、メモリ内でデータを組織化し、SQLオペレータをカラム形式で計算します。カラム形式の組織化は、CPUキャッシュを最大限に活用します。カラム形式の計算は、仮想関数呼び出しと分岐判断の回数を減らし、より効率的なCPU命令フローを実現します。

完全ベクトル化実行エンジンは、SIMD命令も最大限に活用します。このエンジンは、より少ない命令でより多くのデータ操作を完了することができます。標準データセットに対するテストでは、このエンジンにより演算子の総合パフォーマンスが3〜10倍向上しました。

オペレータのベクトル化に加えて、StarRocksはクエリエンジンの他の最適化も実装しています。たとえば、StarRocksはエンコードされたデータ上で直接オペレータを実行するためのOperation on Encoded Data技術を使用しています。デコードの必要性がないため、SQLの複雑さが著しく低減し、クエリの速度が2倍以上向上します。

## ストレージとコンピュートの分離

ストレージ・コンピュートの分離アーキテクチャは3.0から導入されました。このアーキテクチャでは、計算とストレージが切り離されてリソースの分離、コンピュートノードの弾力的なスケーリング、高性能クエリを達成します。ストレージ・コンピュートの分離により、StarRocksは柔軟性が向上し、高性能とデータの可用性が向上し、コストが削減されます。

![shared-data](../assets/share_data_arch.png)

ストレージ・コンピュートの分離モードでは、計算とストレージが切り離され、独立してスケーリングすることができます。これにより、ストレージとコンピューティングのノードを追加したい場合に発生するストレージ・コンピュートのカップリングモードにおけるコストを削減できます。さらに、トラフィックのピークと谷が顕著な場合、コンピューティングは数秒以内に動的にスケーリングされ、リソースの利用が改善されます。

ストレージ層は、オブジェクトストレージのほぼ無制限の容量と高い信頼性を利用して、大量のデータの保存と永続化を実現します。StarRocksはAWS S3、Google Cloud Storage、Azure Blob Storage、HDFS、およびMinIOなどの他のS3互換ストレージなど、さまざまなオブジェクトストレージシステムと連携することができます。

ユーザーは、StarRocksをパブリッククラウド、プライベートクラウド、またはオンプレミスのデータセンターに展開することができます。StarRocksはKubernetesベースの展開をサポートし、ストレージとコンピュートの分離モードのクラスタの自動展開のためのOperatorを提供します。

ストレージ・コンピュートの分離モードでは、ストレージ・コンピュートの連携モードと同じ機能を提供します。データの書き込みとホットデータのクエリパフォーマンスも同様です。ユーザーは、ストレージ・コンピュートの連携モードと同様にデータの更新、データレイクの分析、マテリアライズドビューの高速化を実行することができます。

ストレージとコンピュートを分離したStarRocksクラスタを展開する方法については、[共有データクラスタのデプロイ](../deployment/shared_data/s3.md)を参照してください。

## コストベースのオプティマイザ

![CBO](../assets/1.1-5-cbo.png)

複数のテーブル結合クエリのパフォーマンスは最適化が困難です。実行エンジンのみでは優れたパフォーマンスを提供することはできません。なぜなら、複数のテーブル結合クエリのシナリオでは実行計画の複雑さが数倍にわたって変動する可能性があるからです。関連テーブルが多いほど、実行計画も多くなり、最適な計画を選択することはNP困難になります。効率的なマルチテーブル分析のためには、非常に優れたクエリオプティマイザのみが比較的最適なクエリプランを選択することができます。

StarRocksはゼロから全く新しい[CBO](../using_starrocks/Cost_based_optimizer.md)を設計しています。このCBOは、カスケードのようなフレームワークを採用し、ベクトル化実行エンジンに合わせていくつかの最適化と革新が施されています。これらの最適化には、共通テーブル式（CTE）の再利用、サブクエリの書き換え、Lateral Join、Join Reorder、分散Join実行の戦略選択、および低基数最適化などが含まれます。CBOは、合計99のTPC-DS SQLステートメントをサポートしています。

CBOにより、StarRocksは競合他社よりも優れたマルチテーブル結合クエリのパフォーマンスを実現し、特に複雑なマルチテーブル結合クエリにおいては大きな優位性を持ちます。

## リアルタイムで更新可能なカラムストアエンジン

StarRocksは、同じタイプのデータを連続して格納できるカラムストアエンジンです。カラムストアでは、データをより効率的な方法でエンコードできるため、圧縮比が向上し、ストレージコストが低下します。カラムストアはまた、合計データの読み取りI/Oを減らし、クエリのパフォーマンスを向上させます。また、ほとんどのOLAPシナリオでは、特定の列のみがクエリされます。カラムストアを使用することで、ユーザーは特定の列のみをクエリでき、ディスクI/Oを大幅に削減することができます。

StarRocksはデータを数秒でロードしてリアルタイムに分析することができます。StarRocksのストレージエンジンは、データの挿入操作の原子性、一貫性、分離性、耐久性（ACID）を保証します。データのロードトランザクションでは、トランザクション全体が成功するか失敗します。並行トランザクションは互いに影響を与えず、トランザクションレベルの分離を提供します。

![リアルタイム](../assets/1.1-6-realtime.png)

StarRocksのストレージエンジンは、デリートアンドインサートパターンを使用して、効率的な部分更新操作とUpsert操作を行うことができます。ストレージエンジンは主キーインデックスを使用してデータを迅速にフィルタリングすることができ、データの読み取りでのソートとマージ操作は不要です。エンジンはさらに二次インデックスを最大限に活用することができます。これにより、巨大なデータのアップデートでも高速かつ予測可能なクエリパフォーマンスが実現されます。

## インテリジェントなマテリアライズドビュー

StarRocksはインテリジェントな[マテリアライズドビュー](../using_starrocks/Materialized_view.md)を使用して、クエリとデータウェアハウスのレイヤリングを高速化します。他の類似製品のマテリアライズドビューとは異なり、StarRocksのマテリアライズドビューは、基本テーブルのデータ変更に応じてデータを自動的に更新します。追加のメンテナンス操作は不要です。さらに、マテリアライズドビューの選択も自動的です。StarRocksがクエリパフォーマンスを向上させるための適切なマテリアライズドビュー（MV）を特定すると、クエリを自動的にMVを利用するようにクエリを書き換えます。このインテリジェントなプロセスにより、手動での介入なしにクエリの効率が著しく向上します。

StarRocksのMVは、伝統的なETLデータモデリングプロセスを代替することができます。上流のアプリケーションでデータを変換する代わりに、StarRocks内でMVを使用してデータを変換するオプションがあります。これにより、データ処理パイプラインが簡素化されます。

例えば、図に示すように、データレイク上の元のデータは、外部MVに基づいて正規化されたテーブルを作成するために使用することができます。正規化されたテーブルから非正規化テーブルを非同期のマテリアライズドビューを介して作成することができます。正規化されたテーブルからもう1つのMVを作成して高同時実行クエリとより良いクエリパフォーマンスをサポートすることができます。

![MV](../assets/1.1-7-mv.png)

## データレイク分析

![DLA](../assets/1.1-8-dla.png)

ローカルデータの効率的な分析に加えて、StarRocksはApache Hive、Apache Iceberg、Apache Hudi、Delta Lakeなどのデータレイク（../data_source/catalog/catalog_overview.md）に格納されているデータを分析するためのコンピューティングエンジンとしても機能します。StarRocksのキーフィーチャーの1つは外部カタログであり、外部メタストアへのリンケージを提供します。この機能は、データマイグレーションの必要性をなくし、ユーザーがHDFSやAmazon S3などのさまざまなシステムから、Parquet、ORC、CSVなどのさまざまなファイル形式でデータを分析できるようにします。

前の図は、StarRocksがデータの計算と分析を担当し、データレイクがデータの格納、組織、および保守を担当するデータレイク分析のシナリオを示しています。データレイクのおかげで、ユーザーはオープンなストレージ形式でデータを保存し、柔軟なスキーマを使用して、さまざまなBI、AI、アドホック、およびレポートのユースケースに対する「単一の真実の情報源」のレポートを作成することができます。StarRocksは、ベクトル化エンジンとCBOの利点を最大限に活用し、データレイク分析のパフォーマンスを大幅に向上させます。