---
displayed_sidebar: "Japanese"
---

# リソースグループの作成

## 説明

リソースグループを作成します。

詳細については、[リソースグループ](../../../administration/resource_group.md)を参照してください。

## 構文

```SQL
CREATE RESOURCE GROUP リソースグループ名 
TO クラシファイア1, クラシファイア2, ...
WITH リソース制限
```

## パラメータ

- `リソースグループ名`: 作成されるリソースグループの名前。

- `クラシファイア`: リソース制限が課されるクエリをフィルタリングするために使用されるクラシファイア。 "key"="value" のペアを使ってクラシファイアを指定する必要があります。 リソースグループに複数のクラシファイアを設定することができます。

  クラシファイアのパラメータは以下にリストされています:

    | **パラメータ** | **必須** | **説明**                                              |
    | ------------- | ------------ | ------------------------------------------------------------ |
    | user          | いいえ       | ユーザー名。                                            |
    | role          | いいえ           | ユーザーの役割。                                            |
    | query_type    | いいえ           | クエリのタイプ。 `SELECT` および `INSERT`（v2.5以降）がサポートされています。 `query_type` が `insert` であるリソースグループに INSERT タスクが当たった場合、BE ノードはそのタスクのために指定されたCPUリソースを予約します。   |
    | source_ip     | いいえ           | クエリの初期化元のCIDRブロック。            |
    | db            | いいえ           | クエリがアクセスするデータベース。カンマ（,）で区切られた文字列で指定できます。 |
    | plan_cpu_cost_range | いいえ     | クエリの見積もりCPUコスト範囲。フォーマットは `(DOUBLE, DOUBLE]` です。デフォルト値はNULLで、そのような制限はありませんを示します。このパラメータはv3.1.4以降でサポートされています。                  |
    | plan_mem_cost_range | いいえ     | クエリの見積もりメモリコスト範囲。フォーマットは `(DOUBLE, DOUBLE]` です。デフォルト値はNULLで、そのような制限はありませんを示します。このパラメータはv3.1.4以降でサポートされています。               |

- `リソース制限`: リソースグループに課されるリソース制限。 "key"="value" のペアを使ってリソース制限を指定する必要があります。 リソースグループに複数のリソース制限を設定することができます。

  リソース制限のパラメータは以下にリストされています:

    | **パラメータ**              | **必須** | **説明**                                              |
    | -------------------------- | ------------ | ------------------------------------------------------------ |
    | cpu_core_limit             | いいえ           | BEでリソースグループに割り当てられるCPUコア数のソフトリミット。実際のビジネスシナリオでは、CPUコアはBE上で利用可能なCPUコアに比例してスケーリングされます。 有効な値: 非ゼロの正の整数。 |
    | mem_limit                  | いいえ           | BEが提供する総メモリのうち、クエリに使用できるメモリの割合。単位: %。 有効な値: (0, 1)。 |
    | concurrency_limit          | いいえ           | リソースグループ内の同時クエリの上限。過剰な同時クエリによるシステムの過負荷を避けるために使用されます。 |
    | max_cpu_cores              | いいえ           | 単一のBEノード上でこのリソースグループのCPUコア制限。これは、`0` より大きい値に設定された場合のみ効果があります。範囲: [0, `avg_be_cpu_cores`]、`avg_be_cpu_cores` は全てのBEノードでのCPUコアの平均値を表します。デフォルト: 0。 |
    | big_query_cpu_second_limit | いいえ           | ビッグクエリのCPU占有の最大時間制限。同時クエリは時間を加算します。単位は秒です。 |
    | big_query_scan_rows_limit  | いいえ           | ビッグクエリによってスキャンされる行数の最大制限。 |
    | big_query_mem_limit        | いいえ           | ビッグクエリのメモリ使用量の最大制限。単位はバイトです。 |
    | type                       | いいえ           | リソースグループのタイプ。 有効な値: <br />`short_query`: `short_query` リソースグループからのクエリが実行されている場合、BEノードは `short_query.cpu_core_limit` で定義されたCPUコアを予約します。 すべての `normal` リソースグループのCPUコアは "総CPUコア数 - `short_query.cpu_core_limit`" に制限されます。<br />`normal`: `short_query` リソースグループからのクエリが実行されていない場合、上記のCPUコア制限は `normal` リソースグループには課されません。<br />クラスター内で `short_query` リソースグループを1つだけ作成できることに注意してください。 |

## 例

例1: 複数のクラシファイアに基づいてリソースグループ `rg1` を作成します。

```SQL
CREATE RESOURCE GROUP rg1
TO 
    (user='rg1_user1', role='rg1_role1', query_type in ('select'), source_ip='192.168.x.x/24'),
    (user='rg1_user2', query_type in ('select'), source_ip='192.168.x.x/24'),
    (user='rg1_user3', source_ip='192.168.x.x/24'),
    (user='rg1_user4'),
    (db='db1')
WITH ('cpu_core_limit' = '10',
      'mem_limit' = '20%',
      'type' = 'normal',
      'big_query_cpu_second_limit' = '100',
      'big_query_scan_rows_limit' = '100000',
      'big_query_mem_limit' = '1073741824'
);
```