---
displayed_sidebar: "Japanese"
---

# ストリームロード

## 1. ストリームロードは、CSV形式のファイルの最初の数行に列名を識別するのをサポートしていますか？またはデータの読み込み中に最初の数行をスキップすることはできますか？

ストリームロードは、CSV形式のファイルの最初の数行に列名を識別することをサポートしていません。ストリームロードは、最初の数行を他の行と同様の通常のデータとして扱います。

v2.5およびそれ以前では、ストリームロードはデータの読み込み中にCSVファイルの最初の数行をスキップすることをサポートしていません。CSVファイルの最初の数行が列名を保持している場合は、以下のいずれかの操作を実行してください：

- データをエクスポートするツールの設定を変更します。その後、列名を最初の数行に保持しないCSVファイルとしてデータを再エクスポートします。
- `sed -i '1d' ファイル名` のようなコマンドを使用して、CSVファイルの最初の数行を削除します。
- ロードコマンドまたはステートメントで、 `-H "where: <column_name> != '<column_name>'"` を使用して、CSVファイルの最初の数行をフィルタリングします。 `<column_name>` は最初の数行に保持されている列名のいずれかです。StarRocksはまずデータを変換し、その後ソースデータをフィルタリングします。そのため、最初の数行の列名が宛先のデータ型に変換されない場合、それらに対して`NULL`値が返されます。つまり、宛先のStarRocksテーブルには`NOT NULL`に設定された列を含めることはできません。
- ロードコマンドまたはステートメントで、`-H "max_filter_ratio:0.01"` を追加し、1%以下の最大エラートレランスを設定しますが、エラーレコードをいくつか許容できる場合、これによりStarRocksは最初の数行のデータ変換の失敗を無視することができます。 この場合、`ErrorURL` がエラーレコードを示すように返されても、ストリームロードジョブは成功する可能性があります。`max_filter_ratio`を大きな値に設定しないでください。`max_filter_ratio`を大きな値に設定すると、いくつかの重要なデータ品質の問題が見過ごされる可能性があります。

v3.0以降、ストリームロードは `skip_header` パラメータをサポートし、CSVファイルの最初の数行をスキップするかどうかを指定します。詳細については、[CSVパラメータ](../../sql-reference/sql-statements/data-manipulation/STREAM_LOAD.md#csv-parameters)をご覧ください。

## 2. パーティション列にロードされるデータが標準のDATEまたはINT型でない場合は、どうすればストリームロードを使用してデータを変換できますか？

StarRocksはロード時にデータを変換することをサポートしています。詳細については、[ロード時のデータ変換](../../loading/Etl_in_loading.md)を参照してください。

たとえば、`TEST`という名前のCSV形式のファイルをロードしたい場合、ファイルには `NO`, `DATE`, `VERSION`, `PRICE` の4つの列がありますが、そのうち `DATE` 列のデータは202106.00のような非標準形式であるとします。 StarRocksで `DATE` をパーティション列として使用したい場合は、まず、以下の4つの列 `NO`, `VERSION`, `PRICE`, `DATE` で構成されるStarRocksテーブルを作成し、そのテーブルの `DATE` 列のデータ型をDATE、DATETIME、またはINTに指定する必要があります。 最後に、ストリームロードジョブを作成する際に、以下の設定をロードコマンドまたはステートメントで指定して、ソースの `DATE` 列のデータ型を宛先列のデータ型に変換する必要があります：

```Plain
-H "columns: NO,DATE_1, VERSION, PRICE, DATE=LEFT(DATE_1,6)"
```

上記の例では、`DATE_1` は一時的に宛先 `DATE` 列にマッピングされている列の名前と見なすことができ、宛先の `DATE` 列にロードされる最終的な結果は `left()` 関数によって計算されます。一時的なソース列の名前を最初にリストアップしてから、データを変換するために関数を使用する必要があります。サポートされている関数はスカラー関数で、それには集計関数やウィンドウ関数が含まれます。

## 3. ストリームロードジョブが "body exceed max size: 10737418240, limit: 10737418240" エラーを報告した場合はどうすればよいですか？

ソースデータファイルのサイズが10GBを超えており、これはストリームロードでサポートされている最大ファイルサイズです。 次のいずれかの操作を実行してください：

- `seq -w 0 n` を使用して、ソースデータファイルを複数の小さなファイルに分割します。
- `curl -XPOST http:///be_host:http_port/api/update_config?streaming_load_max_mb=<file_size>` を使用して、[BE構成項目](../../administration/Configuration.md#configure-be-dynamic-parameters) `streaming_load_max_mb` の値を調整して、最大ファイルサイズを増やします。